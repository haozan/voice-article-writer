<div class="min-h-screen bg-gradient-to-br from-primary/5 via-surface to-secondary/5 py-8 px-4">
  <div class="container-lg mx-auto max-w-4xl">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-4xl lg:text-5xl font-bold text-primary mb-3">
        <%= lucide_icon "pen-line", class: "w-10 h-10 inline-block mr-2" %>
        AI 文章写作助手
      </h1>
      <p class="text-lg text-secondary">
        选择 Grok AI、阿里云千问或 DeepSeek 与你聊聊思路
      </p>
    </div>

    <!-- Main Content Wrapper -->
    <div 
      data-controller="voice-recorder articles" 
      data-articles-stream-name-value="<%= @stream_name %>"
      data-action="voice-recorder:completed->articles#onVoiceCompleted"
    >
      
      <!-- Input Section -->
      <div class="card card-elevated p-6 mb-6">
        <!-- LLM Provider Selection -->
        <div class="mb-6 pb-4 border-b border-border">
          <label class="block text-lg font-semibold text-primary mb-3">
            <%= lucide_icon "brain", class: "w-5 h-5 inline-block mr-2" %>
            选择 AI 模型
          </label>
          <div class="flex gap-4">
            <label class="flex items-center gap-3 cursor-pointer group">
              <input 
                type="radio" 
                name="llm_provider" 
                value="grok" 
                checked
                data-articles-target="providerRadio"
                class="w-5 h-5 text-primary border-border focus:ring-2 focus:ring-primary/20"
              >
              <div class="flex items-center gap-2">
                <div class="w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center group-hover:bg-primary/20 transition-colors">
                  <%= lucide_icon "zap", class: "w-5 h-5 text-primary" %>
                </div>
                <div>
                  <div class="font-semibold text-primary">Grok AI</div>
                  <div class="text-sm text-muted">来自 xAI</div>
                </div>
              </div>
            </label>
            
            <label class="flex items-center gap-3 cursor-pointer group">
              <input 
                type="radio" 
                name="llm_provider" 
                value="qwen"
                data-articles-target="providerRadio"
                class="w-5 h-5 text-secondary border-border focus:ring-2 focus:ring-secondary/20"
              >
              <div class="flex items-center gap-2">
                <div class="w-10 h-10 bg-secondary/10 rounded-lg flex items-center justify-center group-hover:bg-secondary/20 transition-colors">
                  <%= lucide_icon "sparkles", class: "w-5 h-5 text-secondary" %>
                </div>
                <div>
                  <div class="font-semibold text-primary">阿里云千问</div>
                  <div class="text-sm text-muted">Qwen3-Max</div>
                </div>
              </div>
            </label>
            
            <label class="flex items-center gap-3 cursor-pointer group">
              <input 
                type="radio" 
                name="llm_provider" 
                value="deepseek"
                data-articles-target="providerRadio"
                class="w-5 h-5 text-accent border-border focus:ring-2 focus:ring-accent/20"
              >
              <div class="flex items-center gap-2">
                <div class="w-10 h-10 bg-accent/10 rounded-lg flex items-center justify-center group-hover:bg-accent/20 transition-colors">
                  <%= lucide_icon "brain", class: "w-5 h-5 text-accent" %>
                </div>
                <div>
                  <div class="font-semibold text-primary">DeepSeek</div>
                  <div class="text-sm text-muted">深度思考</div>
                </div>
              </div>
            </label>
          </div>
        </div>
        
        <div class="mb-4">
          <label class="block text-lg font-semibold text-primary mb-3">
            <%= lucide_icon "message-square", class: "w-5 h-5 inline-block mr-2" %>
            输入你的想法
          </label>
          <textarea
            data-articles-target="inputText"
            class="w-full px-4 py-3 text-lg border-2 border-border rounded-lg focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all resize-none text-foreground bg-surface"
            rows="8"
            placeholder="请输入你的想法、观点或要表达的内容...\n\n你可以：\n• 使用手机输入法直接输入文字\n• 使用手机语音输入功能（系统自带）\n• 随意表达，不必太正式"
          ></textarea>
        </div>
        
        <div class="text-center">
          <button
            type="button"
            data-action="click->articles#generateArticle"
            class="btn-primary btn-lg px-12"
          >
            <%= lucide_icon "sparkles", class: "w-5 h-5 inline-block mr-2" %>
            开始对话
          </button>
        </div>
        
        <p class="text-sm text-muted text-center mt-3">
          提示：在手机上可以使用系统自带的语音输入功能
        </p>
      </div>

      <!-- Grok Response Section -->
      <div class="card card-elevated mb-6 bg-gradient-to-br from-primary/5 to-secondary/5" data-articles-target="responseSection" style="display: none;">
        <div class="card-header border-b border-border flex items-center justify-between">
          <h2 class="text-xl font-bold text-primary flex items-center gap-2">
            <%= lucide_icon "message-circle", class: "w-5 h-5" %>
            Grok 的回应
            <span class="text-sm font-normal text-muted">(来自 xAI 的真实思考)</span>
          </h2>
          <button
            type="button"
            data-action="click->articles#copyArticle"
            data-articles-target="copyButton"
            class="btn-primary btn-sm"
            style="display: none;"
          >
            <%= lucide_icon "copy", class: "w-4 h-4 inline-block mr-1" %>
            复制内容
          </button>
        </div>
        <div class="card-body">
          <div 
            data-articles-target="responseText"
            class="text-secondary text-lg leading-relaxed whitespace-pre-wrap min-h-[200px] max-h-[600px] overflow-y-auto"
          >
            <div class="flex items-center gap-2 text-muted">
              <div class="loading-spinner w-5 h-5"></div>
              <span>Grok 思考中...</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="text-center mt-8" data-articles-target="actionButtons" style="display: none;">
        <button
          type="button"
          data-action="click->articles#reset"
          class="btn-secondary btn-lg px-8"
        >
          <%= lucide_icon "refresh-cw", class: "w-5 h-5 inline-block mr-2" %>
          重新对话
        </button>
      </div>

    </div>

    <!-- Tips Section -->
    <div class="mt-12 text-center">
      <div class="inline-block bg-surface-elevated rounded-xl p-6 shadow-sm">
        <h3 class="text-lg font-bold text-primary mb-4 flex items-center justify-center gap-2">
          <%= lucide_icon "lightbulb", class: "w-5 h-5" %>
          使用提示
        </h3>
        <ul class="text-secondary text-left space-y-2">
          <li class="flex items-start gap-2">
            <%= lucide_icon "check", class: "w-4 h-4 text-success mt-1 flex-shrink-0" %>
            <span>直接在文本框输入你的想法或观点</span>
          </li>
          <li class="flex items-start gap-2">
            <%= lucide_icon "check", class: "w-4 h-4 text-success mt-1 flex-shrink-0" %>
            <span>手机用户可以使用系统自带的语音输入</span>
          </li>
          <li class="flex items-start gap-2">
            <%= lucide_icon "check", class: "w-4 h-4 text-success mt-1 flex-shrink-0" %>
            <span>不用太正式，随意表达即可</span>
          </li>
          <li class="flex items-start gap-2">
            <%= lucide_icon "check", class: "w-4 h-4 text-success mt-1 flex-shrink-0" %>
            <span>选择 Grok AI、阿里云千问或 DeepSeek，体验不同的 AI 风格</span>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<style>
  /* Recording animation */
  [data-voice-recorder-target="micButton"].recording {
    animation: pulse 1.5s ease-in-out infinite;
    background: hsl(var(--color-danger));
  }

  @keyframes pulse {
    0%, 100% {
      transform: scale(1);
      box-shadow: 0 0 0 0 hsl(var(--color-danger) / 0.7);
    }
    50% {
      transform: scale(1.05);
      box-shadow: 0 0 0 20px hsl(var(--color-danger) / 0);
    }
  }

  /* Loading spinner */
  .loading-spinner {
    border: 2px solid hsl(var(--color-border));
    border-top-color: hsl(var(--color-primary));
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
</style>
