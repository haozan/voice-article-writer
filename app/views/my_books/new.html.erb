<% content_for :title, "新建书籍" %>

<div class="min-h-screen bg-gradient-to-br from-amber-50 to-orange-50 dark:from-gray-900 dark:to-gray-800 py-8">
  <div class="container-lg mx-auto px-4 max-w-3xl">
    
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-50 flex items-center gap-3 mb-2">
        <%= lucide_icon "book-plus", class: "w-8 h-8" %>
        新建书籍
      </h1>
      <p class="text-gray-600 dark:text-gray-400">填写书籍基本信息</p>
    </div>

    <!-- Form Card -->
    <div class="card bg-white dark:bg-gray-800 shadow-lg">
      <div class="card-body p-6">
        <%= form_with model: @book, url: my_books_path, class: "space-y-6" do |f| %>
          
          <!-- Title -->
          <div>
            <%= f.label :title, "书籍标题", class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
            <%= f.text_field :title, 
                placeholder: "例如：我的技术笔记",
                class: "form-input w-full #{'border-red-500' if @book.errors[:title].any?}" %>
            <% if @book.errors[:title].any? %>
              <p class="text-red-500 text-sm mt-1"><%= @book.errors[:title].first %></p>
            <% end %>
          </div>

          <!-- Subtitle -->
          <div>
            <%= f.label :subtitle, "副标题", class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
            <%= f.text_field :subtitle, 
                placeholder: "例如：从入门到精通（可选）",
                class: "form-input w-full" %>
            <p class="text-gray-500 text-sm mt-1">可选，用于补充说明书籍主题</p>
          </div>

          <!-- Author -->
          <div>
            <%= f.label :author, "作者", class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
            <%= f.text_field :author, 
                placeholder: "例如：张三",
                class: "form-input w-full" %>
          </div>

          <!-- Description -->
          <div>
            <%= f.label :description, "书籍简介", class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
            <%= f.text_area :description, 
                rows: 4,
                placeholder: "简要介绍这本书的内容和特点...",
                class: "form-input w-full" %>
          </div>

          <!-- Cover Style -->
          <div>
            <%= f.label :cover_style, "封面风格", class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3" %>
            <div class="grid grid-cols-2 md:grid-cols-5 gap-3">
              <% Book::COVER_STYLES.each do |style, name| %>
                <label class="relative cursor-pointer">
                  <%= f.radio_button :cover_style, style, 
                      class: "peer sr-only",
                      checked: (@book.cover_style || 'minimal') == style %>
                  <div class="card border-2 border-gray-300 peer-checked:border-primary peer-checked:bg-primary/5 transition-all hover:border-primary/50 text-center p-3">
                    <div class="aspect-[3/4] bg-gradient-to-br <%= case style
                      when 'minimal' then 'from-gray-600 to-gray-800'
                      when 'gradient' then 'from-blue-500 to-purple-600'
                      when 'literary' then 'from-amber-600 to-orange-700'
                      when 'modern' then 'from-teal-500 to-cyan-600'
                      when 'academic' then 'from-gray-100 to-gray-200 border border-gray-400'
                    end %> rounded mb-2"></div>
                    <span class="text-sm font-medium text-gray-700 dark:text-gray-300"><%= name %></span>
                  </div>
                </label>
              <% end %>
            </div>
            <p class="text-gray-500 text-sm mt-2">选择封面设计风格，稍后可以更改</p>
          </div>

          <!-- Status -->
          <div>
            <%= f.label :status, "发布状态", class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
            <div class="flex gap-4">
              <label class="flex items-center cursor-pointer">
                <%= f.radio_button :status, 'draft', checked: true, class: "form-radio" %>
                <span class="ml-2 text-gray-700 dark:text-gray-300">草稿</span>
              </label>
              <label class="flex items-center cursor-pointer">
                <%= f.radio_button :status, 'published', class: "form-radio" %>
                <span class="ml-2 text-gray-700 dark:text-gray-300">已发布</span>
              </label>
            </div>
            <p class="text-gray-500 text-sm mt-1">草稿状态下只有你可以看到这本书</p>
          </div>

          <!-- Pinned -->
          <div>
            <label class="flex items-center cursor-pointer">
              <%= f.check_box :pinned, class: "form-checkbox" %>
              <span class="ml-2 text-gray-700 dark:text-gray-300">置顶显示</span>
            </label>
            <p class="text-gray-500 text-sm mt-1 ml-6">置顶的书籍会显示在列表最前面</p>
          </div>

          <!-- Action Buttons -->
          <div class="flex gap-3 pt-4">
            <%= link_to my_books_path, class: "btn-ghost flex-1" do %>
              <%= lucide_icon "x", class: "w-5 h-5 mr-2" %>
              取消
            <% end %>
            <%= f.submit "创建书籍", class: "btn-primary flex-1" %>
          </div>

        <% end %>
      </div>
    </div>

    <!-- Tips -->
    <div class="card bg-blue-50 dark:bg-blue-900/20 shadow-lg mt-6">
      <div class="card-body p-4">
        <div class="flex items-start gap-3">
          <%= lucide_icon "info", class: "w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" %>
          <div class="text-sm text-blue-800 dark:text-blue-200">
            <p class="font-medium mb-1">提示：</p>
            <ul class="space-y-1">
              <li>• 创建书籍后，你可以在书籍详情页添加章节</li>
              <li>• 章节支持多级嵌套，方便组织内容结构</li>
              <li>• 完成的文章可以归档到对应的章节中</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
